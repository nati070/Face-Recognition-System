[{"id":"5539219c.948cd","type":"tab","label":"Monitor_entry","disabled":false,"info":""},{"id":"7196cd16.92b724","type":"websocket out","z":"5539219c.948cd","name":"","server":"641a5868.ed21a8","client":"","x":1180,"y":240,"wires":[]},{"id":"9c854ae7.9df7c8","type":"http response","z":"5539219c.948cd","name":"","statusCode":"","headers":{},"x":990,"y":60,"wires":[]},{"id":"291b5788.e83248","type":"http in","z":"5539219c.948cd","name":"","url":"/simple","method":"get","swaggerDoc":"","x":559,"y":60,"wires":[["7daedf90.e3819"]]},{"id":"7daedf90.e3819","type":"template","z":"5539219c.948cd","name":"MainPage","field":"payload","fieldType":"msg","format":"html","syntax":"mustache","template":"<!DOCTYPE HTML>\n<html>\n<head>\n    <style>\n        * {\n            box-sizing: border-box;\n        }\n        .homePage {\n            object-fit: cover;\n            width: 100%;\n            height: 100vh;\n            position: absolute;\n            top: 0;\n            left: 0;\n            overflow: hidden;\n        }\n\n        .authorizedText {\n            position: absolute;\n            text-align: center;\n            color: white;\n            top: 10%;\n            left: 39%;\n            font-size: 200%;\n        }\n\n        .picOnDB {\n            position: absolute;\n            width: 250px;\n            height: 300px;\n            left: 50%;\n            top: 35%;\n        }\n\n        .getTheName {\n            position: absolute;\n            top: 60%;\n            z-index: 99;\n            right: 45%;\n            font-size: 40px;\n        }\n\n        .detailsPerson {\n            position: absolute;\n            top: 30%;\n            z-index: 99;\n            right: 20%;\n            font-size: 40px;\n        }\n\n        .connection {\n            position: absolute;\n            right: 5%;\n            bottom: 5%;\n            font-size: 150%;\n        }\n\n        .msg {\n            position: absolute;\n            top: 70%;\n            left: 45%;\n            font-size: 200%;\n            color: white;\n        }\n\n\n    </style>\n    <script type=\"text/javascript\">\n        var ws;\n        var wsUri = \"ws:\";\n        var loc = window.location;\n        console.log(loc);\n        if (loc.protocol === \"https:\") { wsUri = \"wss:\"; }\n        // This needs to point to the web socket in the Node-RED flow\n        // ... in this case it's ws/simple\n        wsUri += \"//\" + loc.host + loc.pathname.replace(\"simple\", \"ws/simple\");\n        function wsConnect() {\n            console.log(\"connect\", wsUri);\n            ws = new WebSocket(wsUri);\n            //var line = \"\";    // either uncomment this for a building list of messages\n            ws.onmessage = function (msg) {\n                var data = msg.data;\n                //console.log(data);\n                //check what we got from the server if it is the name or snapshot or pic from DB\n                if (data.length < 30) {\n                    //ws.send(JSON.stringify({data:data}));\n                    identifyPerson(data);\n                }\n                else if (data.includes(\".png\")) {\n                    line = data;\n                    var DBpic = document.getElementById('DBpic');\n                    DBpic.innerHTML = \"<img style='display:block; width:250px;height:300px;' src=\" + line + \">\";                                \n                }\n                else {\n                    line = \"<img style='display:block; width:250px;height:300px;' src=\\\"data:image/png;base64,\" + data + \"\\\" alt=\" + \"\\\"Red dot\\\"\" + \"/>\";\n                    var snapshot = document.getElementById('snapshot');\n                    snapshot.innerHTML = line; \n                }\n            }\n            ws.onopen = function () {\n                // update the status div with the connection status\n                document.getElementById('status').innerHTML = \"connected\";\n                document.getElementById('status').style.color = \"Green\";\n                //ws.send(\"Open for data\");\n                console.log(\"connected\");\n            }\n            ws.onclose = function () {\n                // update the status div with the connection status\n                document.getElementById('status').innerHTML = \"not connected\";\n                document.getElementById('status').style.color = \"Red\";\n                // in case of lost connection tries to reconnect every 3 secs\n                setTimeout(wsConnect, 3000);\n            }\n        }\n\n        function doit(m) {\n            if (ws) { ws.send(m); }\n        }\n          //change screen background to red and output the snapshot \n        function changeBGRed() {\n            var video = document.getElementById('myVideo');\n            video.pause();\n            video.src = \"https://cdn.kapwing.com/final_5f5508092f85350083b949f3_168017.mp4\";\n\n            //button  to aprove unautorized person\n            var button = document.createElement('button');\n            button.className = \"msg\";\n            button.innerHTML = \"approve enter!\";\n            button.style.left = \"45%\";\n            button.style.top = \"80%\";\n            button.style.fontSize = \"200%\";\n            button.addEventListener(\"click\", function () {\n                //button.style.visibility = 'hidden';\n                location.reload();\n            });\n\n            document.body.appendChild(button);\n        }\n          //change screen background to blue\n        function changeBGBlue() {\n            var video = document.getElementById('myVideo');\n            video.pause();\n            video.src = \"https://cdn.kapwing.com/final_5f55079c0a793e007d469f26_235305.mp4\";   //\n        }\n\n\n        //change screen background to green\n        function changeBGGreen() {\n            var video = document.getElementById('myVideo');\n            video.pause();\n            video.src = \"https://cdn.kapwing.com/final_5f55086448a16a002c15f0e7_187884.mp4\";\n        }\n\n        // person was identify by the camera give alert or approve\n        async function identifyPerson(id) {\n            var line = \"\";  // or uncomment this to overwrite the existing message\n            // parse the incoming message as a JSON object\n            // id = document.getElementById('messages').innerHTML;\n            console.log(id);\n            // undefined undefined \n            if (id == \"undefined undefined\") {\n                changeBGRed();\n                // replace the messages div with the new \"line\"\n                line += \"<p>\" + \"warning: unauthorized person\" + \"</p>\";\n                var msg = document.getElementById('messages');\n                msg.innerHTML = line;\n                msg.style.left = \"40%\";\n                snapshot.style.position = \"absolute\";\n                snapshot.style.left = \"45%\";\n                snapshot.style.top = \"35%\";\n                \n            }\n            else if (id != \"\") {\n                line += \"<p> Name: \" + id + \"</p>\";\n                changeBGGreen();\n                snapshot.style.position = \"absolute\";\n                snapshot.style.left = \"37%\";\n                snapshot.style.top = \"35%\";\n\n                DBpic.style.position = \"absolute\";\n                DBpic.style.left = \"50%\";\n                DBpic.style.top = \"35%\"\n                \n                // replace the messages div with the new \"line\"\n                document.getElementById('messages').innerHTML = line;\n                await sleep(15000);\n                // build the output from the topic and payload parts of the object\n               location.reload();\n                \n            }\n        }\n        function sleep(ms) {\n            return new Promise(resolve => setTimeout(resolve, ms));\n        }\n    </script>\n</head>\n\n<body onload=\"wsConnect();\" onunload=\"ws.disconnect();\">\n    <div class=homePage>\n        <!-- The video -->\n        <video autoplay muted loop id=\"myVideo\" src=\"https://cdn.kapwing.com/final_5f55079c0a793e007d469f26_235305.mp4\"\n            type=\"video/mp4\">\n        </video>\n        <div>\n            <h1 class=authorizedText>\n                <strong>authorized/unauthorized enter</strong>\n                <hr />\n            </h1>\n            <div id=\"snapshot\"></div>\n            <div class=msg id=\"messages\"></div>\n            <div class=\"picOnDB\" id = DBpic></div>\n            <div class=connection>\n                <div id=\"status\">unknown</div>\n            </div>\n        </div>\n    </div>\n</body>\n\n</html>","x":760,"y":60,"wires":[["9c854ae7.9df7c8"]]},{"id":"68a62ab4.745514","type":"websocket in","z":"5539219c.948cd","name":"","server":"641a5868.ed21a8","client":"","x":1060,"y":640,"wires":[["17a54c68.b42464"]]},{"id":"17a54c68.b42464","type":"debug","z":"5539219c.948cd","name":"","active":true,"console":"false","complete":"false","x":1290,"y":640,"wires":[]},{"id":"1379af9a.4f5ba","type":"mysql","z":"5539219c.948cd","mydb":"146edf88.8d055","name":"openmv_mysql","x":520,"y":240,"wires":[["cc691ec4.4e17c"]]},{"id":"bd1da634.efc6b8","type":"function","z":"5539219c.948cd","name":"IdPerson","func":"var idPrson  = 0 //  msg.payload;\nmsg.topic = 'select * from openmv.person  where PersonID LIKE ' + idPrson;\nreturn msg;\n","outputs":1,"noerr":0,"x":280,"y":240,"wires":[["1379af9a.4f5ba"]]},{"id":"cc691ec4.4e17c","type":"function","z":"5539219c.948cd","name":"isExist","func":"if (msg.payload.length === 0){\n     throw \"undefined person in opem camera DB\";\n}\nreturn msg;","outputs":1,"noerr":0,"x":750,"y":240,"wires":[["bc0a8f9b.40153","7bff5848.4c3a28","fd9f1ebe.23dee"]]},{"id":"bc0a8f9b.40153","type":"function","z":"5539219c.948cd","name":"addToTimeTable","func":"var id = msg.payload[0].PersonID;\nmsg.topic = 'INSERT INTO openmv.who_entered (PersonID ,EnteredTime) VALUES (' + id + ', CURRENT_TIMESTAMP);'\n\nreturn msg;","outputs":1,"noerr":0,"x":940,"y":160,"wires":[["e411e729.008ae8"]]},{"id":"e411e729.008ae8","type":"mysql","z":"5539219c.948cd","mydb":"146edf88.8d055","name":"openmv_mysql","x":1180,"y":160,"wires":[[]]},{"id":"7bff5848.4c3a28","type":"function","z":"5539219c.948cd","name":"uploadName","func":"msg.payload = msg.payload[0].LastName +\" \" + msg.payload[0].FirstName;\nreturn msg;","outputs":1,"noerr":0,"x":930,"y":240,"wires":[["7196cd16.92b724"]]},{"id":"d970a88d.633f68","type":"e-mail","z":"5539219c.948cd","server":"smtp.gmail.com","port":"465","secure":true,"tls":false,"name":"nnati070@gmail.com","dname":"NatiGmail","x":1220,"y":320,"wires":[]},{"id":"fd9f1ebe.23dee","type":"function","z":"5539219c.948cd","name":"IfUndefined ","func":"if ( msg.payload[0].PersonID === 0){\n   msg.topic = \"warning\"\n   msg.payload =  \"warning: undefined person\";\n   return msg;\n }","outputs":1,"noerr":0,"x":930,"y":320,"wires":[["d970a88d.633f68"]]},{"id":"612704.3cd108fc","type":"mqtt in","z":"5539219c.948cd","name":"openmv/test","topic":"openmv/test","qos":"2","datatype":"auto","broker":"b091e7e9.d57e68","x":70,"y":300,"wires":[["bd1da634.efc6b8","a935e46c.4ad0f8"]]},{"id":"53be3c62.b48114","type":"inject","z":"5539219c.948cd","name":"Tick every 15 secs","topic":"test","payload":"","payloadType":"date","repeat":"15","crontab":"","once":false,"onceDelay":"","x":90,"y":180,"wires":[[]]},{"id":"61ccc5d9.540a9c","type":"mqtt in","z":"5539219c.948cd","name":"","topic":"openmv/pic","qos":"2","datatype":"base64","broker":"b091e7e9.d57e68","x":250,"y":820,"wires":[["581422d9.e4fc4c","5f27153d.927acc"]]},{"id":"581422d9.e4fc4c","type":"base64","z":"5539219c.948cd","name":"","action":"","property":"payload","x":460,"y":820,"wires":[[]]},{"id":"7e5c7e12.a3f8a","type":"image","z":"5539219c.948cd","name":"","width":160,"data":"payload","dataType":"msg","thumbnail":false,"active":true,"pass":false,"outputs":0,"x":640,"y":820,"wires":[]},{"id":"5f27153d.927acc","type":"websocket out","z":"5539219c.948cd","name":"","server":"641a5868.ed21a8","client":"","x":480,"y":740,"wires":[]},{"id":"823bcbee.d6d598","type":"inject","z":"5539219c.948cd","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":80,"y":740,"wires":[["df6ebf5d.c7f82"]]},{"id":"df6ebf5d.c7f82","type":"function","z":"5539219c.948cd","name":"EXAMPLE1","func":"msg.payload = \"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\"\nreturn msg;","outputs":1,"noerr":0,"x":270,"y":740,"wires":[[]]},{"id":"c6f8962b.1c2958","type":"comment","z":"5539219c.948cd","name":"website","info":"the website itsself\n","x":410,"y":60,"wires":[]},{"id":"a3c04ae8.12f2e8","type":"comment","z":"5539219c.948cd","name":"picfromcam","info":"got a pic from the openmv camera and send it t the web","x":90,"y":820,"wires":[]},{"id":"a935e46c.4ad0f8","type":"function","z":"5539219c.948cd","name":"idPersonImg","func":"var idPrson  = 0// msg.payload;\nmsg.topic = 'select * from openmv.pictue_of_person where PersonID LIKE ' + idPrson;\nreturn msg;\n","outputs":1,"noerr":0,"x":290,"y":420,"wires":[["fd4ccbcd.03a7a8"]]},{"id":"fd4ccbcd.03a7a8","type":"mysql","z":"5539219c.948cd","mydb":"146edf88.8d055","name":"openmv_mysql","x":540,"y":420,"wires":[["e45e4152.b7b93"]]},{"id":"e45e4152.b7b93","type":"function","z":"5539219c.948cd","name":"isExist","func":"if (msg.payload.length === 0){\n     throw \"undefined person in opem camera DB\";\n}\nreturn msg;","outputs":1,"noerr":0,"x":730,"y":420,"wires":[["4d5549fe.f50468"]]},{"id":"7af8feb6.1c9d7","type":"websocket out","z":"5539219c.948cd","name":"","server":"641a5868.ed21a8","client":"","x":1160,"y":420,"wires":[]},{"id":"4d5549fe.f50468","type":"function","z":"5539219c.948cd","name":"uploadIMG","func":"msg.payload = msg.payload[0].Image;\nreturn msg;","outputs":1,"noerr":0,"x":950,"y":420,"wires":[["7af8feb6.1c9d7"]]},{"id":"ea0c8727.4dca48","type":"inject","z":"5539219c.948cd","name":"","topic":"","payload":"","payloadType":"date","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":60,"y":400,"wires":[[]]},{"id":"5cef57e.0436fa8","type":"e-mail","z":"5539219c.948cd","server":"smtp.gmail.com","port":"435","secure":false,"tls":false,"name":"nnati070@gmail.com","dname":"natiMail","x":1580,"y":320,"wires":[]},{"id":"641a5868.ed21a8","type":"websocket-listener","z":"5539219c.948cd","path":"/ws/simple","wholemsg":"false"},{"id":"146edf88.8d055","type":"MySQLdatabase","z":"","name":"","host":"127.0.0.1","port":"3306","db":"openmv","tz":"","charset":"UTF8"},{"id":"b091e7e9.d57e68","type":"mqtt-broker","z":"","name":"","broker":"test.mosquitto.org","port":"1883","tls":"","clientid":"","usetls":false,"compatmode":true,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthRetain":"false","birthPayload":"","closeTopic":"","closeQos":"0","closeRetain":"false","closePayload":"","willTopic":"","willQos":"0","willRetain":"false","willPayload":""}]